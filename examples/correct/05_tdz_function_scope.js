/**
 * TDZ 퀴즈 #1 - 함수 내부 let과 TDZ + 섀도잉
 *
 * 문제:
 * let x = 1;
 * function foo() {
 *   console.log(x);
 *   let x = 2;
 * }
 * foo();
 *
 * 정답: ReferenceError: Cannot access 'x' before initialization
 */

// ============================================
// 원본 코드
// ============================================

let x = 1;

function foo() {
  // console.log(x);  // ReferenceError!
  let x = 2;
}

// foo();

// ============================================
// 왜 에러가 나는가?
// ============================================

// 1. 함수 내부에 let x가 있음 → 지역 변수 x가 전역 x를 가림 (섀도잉)
// 2. let은 TDZ가 있음 → 초기화 전 접근 시 에러

// foo() 호출 시 JS 엔진 해석:
// function foo() {
//   let x;           // 호이스팅 (TDZ 시작)
//   console.log(x);  // 에러! (전역 x가 아닌 지역 x 참조, TDZ 구간)
//   x = 2;           // TDZ 끝
// }

// ============================================
// var와의 차이
// ============================================

// var x → 섀도잉 + undefined
// let x → 섀도잉 + TDZ 에러

var y = 1;
function bar() {
  console.log(y);  // undefined (var는 TDZ 없음)
  var y = 2;
}
bar();

// ============================================
// 핵심: 함수 호출 시점에 호이스팅 발생
// ============================================

// function foo() {
//   console.log(x);
//   let x = 2;
// }
//
// 여기까지는 foo 내부의 x는 아무 일도 안 일어남
//
// foo();  ← 호출 순간:
//   1. foo 실행 컨텍스트 생성
//   2. foo 스코프 내 변수들 호이스팅 (let x 선언)
//   3. 코드 실행 (console.log(x) → TDZ 에러)

// ============================================
// 스코프별 호이스팅
// ============================================

// 각 스코프마다 독립적으로 호이스팅이 일어남
// - 전역 스코프 → 전역 변수/함수 호이스팅
// - 함수 스코프 → 해당 함수 내 변수/함수 호이스팅
// - 블록 스코프 → 해당 블록 내 let/const 호이스팅

// 호이스팅은 "해당 스코프의 최상단"으로 끌어올려지는 것
// 전역 최상단이 아님!

// ============================================
// 실행해보기: node examples/correct/05_tdz_function_scope.js
// ============================================
